---
title: "nbastatR"
output: html_document
date: '2022-06-13'
---

```{r setup, include=FALSE}
library(ggplot2)
library(caret)
library(tidyverse)
library(nbastatR)
suppressPackageStartupMessages(library(tidyverse))
# suppressPackageStartupMessages(library(highcharter))
```



```{r Salary, echo = FALSE}
library(dplyr)
df_salaries <-
hoopshype_salaries(
  teams = NULL,
  all_teams = TRUE,
  assume_player_opt_out = T,
  assume_team_doesnt_exercise = T,
  nest_data = F,
  return_message = FALSE
)
df_salaries
```




```{r salary summary}
hoops_hype_salary_summary(return_wide = T, return_message = T)
```




```{r B Ref stats}
bref_stats <- bref_players_stats(
  seasons = 2017:2018,
  tables = c("advanced", "totals"),
  include_all_nba = F,
  only_totals = TRUE,
  nest_data = FALSE,
  assign_to_environment = TRUE,
  widen_data = TRUE,
  join_data = TRUE,
  return_message = TRUE
)
```



```{r Get Credit & AV }
# Credit
bref_stats$credit <- (bref_stats$ptsTotals + bref_stats$trbTotals + bref_stats$astTotals + bref_stats$stlTotals + bref_stats$blkTotals) - (bref_stats$fgaTotals - bref_stats$fgmTotals) - (bref_stats$ftaTotals - bref_stats$ftmTotals) - bref_stats$tovTotals

# AV
bref_stats$AV <- (bref_stats$credit**(0.75))/21

```



```{r Get $/MIN}
full_tbl <- merge(df_salaries, bref_stats, by = "namePlayer")

# Get MP & $/MIN
full_tbl$cash_per_min<- full_tbl$amountContract/full_tbl$minutesTotals

```




```{r cash_per_min vs AV}
library(ggplot2)

ggplot(full_tbl, aes(x=cash_per_min, y=AV, color = groupPosition)) + geom_point()
```

```{r gamesPlayed}
ggplot(data = full_tbl) +
  geom_histogram(mapping = aes(x = countGames), binwidth = 0.5)
```



```{r gamesPlayed by position}
ggplot(data = full_tbl, mapping = aes(x = groupPosition, y = countGames)) +
  geom_boxplot()
```



```{r cash_per_min vs AV}

games60_tbl <- filter(full_tbl, countGames >= 60)
ggplot(games60_tbl, aes(x=cash_per_min, y=AV, color = groupPosition)) + geom_point()
```


